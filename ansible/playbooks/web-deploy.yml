---
- hosts: web
  remote_user: ubuntu
  tasks:
    - template: src=templates/server.service dest=/etc/systemd/system/server.service
      become: yes
    - command: systemctl daemon-reload
      become: yes
    - service: name=server state=stopped
      become: yes
    - file: path='/home/ubuntu/library-management-system-1.0-SNAPSHOT' state=absent
      become: yes
    - unarchive: src=../../server/target/universal/library-management-system-1.0-SNAPSHOT.tgz dest=~/
    - service: name=server state=started
      become: yes
    - command: systemctl enable server
      become: yes
